<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Search for up to 200 places with Radar Search</title>

    <link rel="stylesheet" href="css/estilos.min.css">
    <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #map {
        height: 100%;
      }

      .infobox-wrapper {
    display:none;
}
#infobox {
    border:2px solid black;
    margin-top: 8px;
    background:#333;
    color:#FFF;
    font-family:Arial, Helvetica, sans-serif;
    font-size:12px;
    padding: .5em 1em;
    -webkit-border-radius: 2px;
    -moz-border-radius: 2px;
    border-radius: 2px;
    text-shadow:0 -1px #000000;
    -webkit-box-shadow: 0 0  8px #000;
    box-shadow: 0 0 8px #000;
}
    </style>
    <script>
// This example requires the Places library. Include the libraries=places
// parameter when you first load the API. For example:
// <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places">

window.onload = function() {

};

var map;
var infoWindow;
var service;

function initMap() {
  var startPos;
  var geoOptions = {
    enableHighAccuracy: true
  }

  var geoSuccess = function(position) {

    var mapOptions = {
        // How zoomed in you want the map to start at (always required)
        zoom: 11,

        // The latitude and longitude to center the map (always required)
        center: new google.maps.LatLng(40.6700, -73.9400), // New York

        // How you would like to style the map.
        // This is where you would paste any style found on Snazzy Maps.
        styles: [{"featureType":"all","elementType":"labels.text.fill","stylers":[{"saturation":36},{"color":"#000000"},{"lightness":40}]},{"featureType":"all","elementType":"labels.text.stroke","stylers":[{"visibility":"on"},{"color":"#000000"},{"lightness":16}]},{"featureType":"all","elementType":"labels.icon","stylers":[{"visibility":"off"}]},{"featureType":"administrative","elementType":"geometry.fill","stylers":[{"color":"#000000"},{"lightness":20}]},{"featureType":"administrative","elementType":"geometry.stroke","stylers":[{"color":"#000000"},{"lightness":17},{"weight":1.2}]},{"featureType":"landscape","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":20}]},{"featureType":"poi","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":21}]},{"featureType":"road.highway","elementType":"geometry.fill","stylers":[{"color":"#000000"},{"lightness":17}]},{"featureType":"road.highway","elementType":"geometry.stroke","stylers":[{"color":"#000000"},{"lightness":29},{"weight":0.2}]},{"featureType":"road.arterial","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":18}]},{"featureType":"road.local","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":16}]},{"featureType":"transit","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":19}]},{"featureType":"water","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":17}]}]
    };
    var infobox;

    startPos = position;
    //document.getElementById('startLat').innerHTML = startPos.coords.latitude;
    //document.getElementById('startLon').innerHTML = startPos.coords.longitude;
    map = new google.maps.Map(document.getElementById('map'), {
      center: {lat: startPos.coords.latitude , lng: startPos.coords.longitude},
      zoom: 15,
      styles: [{
        stylers: [{ visibility: 'simplified' }]
      }, {
        elementType: 'labels',
        stylers: [{ visibility: 'off' }]
      }]
    });

  //  infoWindow = new google.maps.InfoWindow();
    service = new google.maps.places.PlacesService(map);
    map.addListener('idle', performSearch);
  };
  var geoError = function(error) {
    console.log('Error occurred. Error code: ' + error.code);
    // error.code can be:
    //   0: unknown error
    //   1: permission denied
    //   2: position unavailable (error response from location provider)
    //   3: timed out
  };

  navigator.geolocation.getCurrentPosition(geoSuccess, geoError, geoOptions);





  // The idle event is a debounced event, so we can query & listen without
  // throwing too many requests at the server.
//
}

function performSearch() {
  var request = {
    bounds: map.getBounds(),
    keyword: 'hamburgueseria'
  };
  service.radarSearch(request, callback);
}

function callback(results, status) {
  if (status !== google.maps.places.PlacesServiceStatus.OK) {
    console.error(status);
    return;
  }
  for (var i = 0, result; result = results[i]; i++) {
    addMarker(result);
  }
}

function addMarker(place) {
  var marker = new google.maps.Marker({
    map: map,
    position: place.geometry.location,
    icon: {
      url: 'https://s3.amazonaws.com/com.cartodb.users-assets.production/production/0xbunny/assets/20150929061600pinfinal.png',
      anchor: new google.maps.Point(10, 10),
      scaledSize: new google.maps.Size(24, 30)
    }
  });

  infobox = new InfoBox({
          content: document.getElementById("infobox"),
          disableAutoPan: false,
          maxWidth: 150,
          pixelOffset: new google.maps.Size(-140, 0),
          zIndex: null,
          boxStyle: {
             background: "url('http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobox/examples/tipbox.gif') no-repeat",
             opacity: 0.75,
             width: "280px"
         },
         closeBoxMargin: "12px 4px 2px 2px",
         closeBoxURL: "http://www.google.com/intl/en_us/mapfiles/close.gif",
         infoBoxClearance: new google.maps.Size(1, 1)
     });

     google.maps.event.addListener(marker, 'click', function() {
         infobox.open(map, this);
         map.panTo(position);
     });


}

    </script>
  </head>
  <body>

        <div id="header"></div>
    <div id="map"></div>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAQfcDN9E0XZQcuYDEV4WaYK0J_4Q63mi4&signed_in=true&libraries=places&callback=initMap" async defer></script>

    <div id="sidebar">


          <div id="spacing"></div>
          <div id="cerrar"></div>
          <div id="menu">
            <ul>
              <li>
                <a href="#"><img src="css/img/icons/joint.png" alt="" /></a>
              </li>
              <li>
                <a href="#"><img src="css/img/icons/veggie.png" alt="" /></a>
              </li>
              <li>
                <a href="#"><img src="css/img/icons/open.png" alt="" /></a>
              </li>
              <li>
                <a href="#"><img src="css/img/icons/delivery.png" alt="" /></a>
              </li>
              <li>
                <a href="#"><img src="css/img/icons/credit.png" alt="" /></a>
              </li>
              <li>
                <a href="#"><img src="css/img/icons/price.png" alt="" /></a>
              </li>
            </ul>
          </div>
          <div class="infobox-wrapper">
    <div id="infobox">
        The contents of your info box. It's very easy to create and customize.
    </div>
</div>
  </body>
</html>
